<!DOCTYPE html>
<html>
<head>
    <title>CS 3300 Project 2</title>
    
    <!-- JavaScript
    ================================================== -->
    <script src="d3.v3.min.js" charset="utf-8"></script>
    <script src="topojson.v1.min.js"></script>
    
    <!-- Basic Page Styles
    ================================================== -->
	<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700|Roboto+Slab:400,700' rel='stylesheet' type='text/css'>
    <style>
        * { box-sizing: border-box; }
        body { width: 1000px; margin: 3em auto; font-family: "Roboto Slab"; }
        html { background: #dfdfdf; font-family: sans-serif; font-size: 1.05em; line-height: 1.25; }
        .paper { width: 100%; background: #fff; border: 1px solid #cfcfcf; box-shadow: 0px 3px 4px 0px rgba(0,0,0,0.2); font-family: Montserrat; }
        .card { padding: 1.5em 2.5em; margin: 3em auto; }
        .sheet { padding: 5em; margin: 3em auto; }
        p { margin-bottom: 2em; }
        small, .muted { color: #555; }
        header { margin-bottom: 5em; }
        .response { display: inline-block; line-height: 1.5; border-left: 3px solid #dfdfdf; padding: .5em 0 .5em 1.5em; }
		.main-title { color: #444; font-size: 3.5em; text-align: center; margin: .5em auto; padding: 0; font-family: "Roboto Slab"; }
		.sub-title { color: #555; font-size: 1.35em; line-height: 1.75; text-align: center; border-top: 1px solid #dfdfdf; padding-top: 1em; }
		.section-title { color: #444; font-size: 3.5em; text-align: center; margin: 2em auto .5em auto; padding: 0; }
		svg { }
    </style>
</head>
<body>
	
	<header class="paper card">
		<h1 class="main-title">
			<small>Worldwide AIDS / US Unemployment</small><br>
			Which dataset is easier ???
		</h1>
		<p class="sub-title">
			<b>CS 3300 Project Two</b><br>
			Names --
		</p>
	</header>
    
	<!-- Overview Map
    ================================================== -->
	<section>
		<h2 class="section-title">Overview Map</h2>
		<div id="map" class="paper"></div>
	

		<!-- Overview Map Styles
		================================================== -->
		<style>
			.state-2, .state-15 { fill: none; stroke: none; display: none; }
			#map .label {
				fill: #555;
				font-size: 14px;
				font-weight: bold;
				text-anchor: middle;
			}
		</style>

		<!-- Generate Overview Map Visuals
		================================================== -->
		<script>		
			var ovMapWidth = 1000,
				ovMapHeight = 618;
			
			var ovMapprojection = d3.geo.albersUsa().scale(800).translate([ovMapWidth / 2, ovMapHeight / 2]);
			var usaPathData = d3.geo.path().projection(ovMapprojection);
			
			// Sets up SVG Canvas within #map element	
			var map_svg = d3.select("#map").append("svg")
				.attr("width", ovMapWidth)
				.attr("height", ovMapHeight);
			var usaData;
			var statePaths;
			var statesData;
			
			// Draws the map of the USA
			d3.json("us.json", function(error, usa) {
				usaData = usa;
				statesData = topojson.feature(usa, usa.objects.states).features;
				statePaths = map_svg.append("g");
				
				// Draws each state. Each state should have attribute id = "state-##"
				statePaths.selectAll("path").data(statesData)
					.enter().append("path").attr("d", usaPathData)
					.attr("class", function(state) { return "state-" + state.id; })
					.attr("fill", "#dfdfdf")
					.style("stroke", "#fff")
					.style("stroke-width", "1.5");
				
				// New York	
				statePaths.selectAll(regionStateClasses[0])
					.attr("transform", "translate(0, -20)");
				
				// Middle States	
				statePaths.selectAll(regionStateClasses[1])
					.attr("transform", "translate(20, 0)");
				
				// New England States	
				statePaths.selectAll(regionStateClasses[2])
					.attr("transform", "translate(20, -20)");	
				
				// Midwest States	
				statePaths.selectAll(regionStateClasses[3])
					.attr("transform", "translate(0, 0)");	
				
				// South States	
				statePaths.selectAll(regionStateClasses[4])
					.attr("transform", "translate(10, 20)");	
				
				// Southwest States	
				statePaths.selectAll(regionStateClasses[5])
					.attr("transform", "translate(-10, 20)");
					
				// West States	
				statePaths.selectAll(regionStateClasses[6])
					.attr("transform", "translate(-20, -20)");
					
				
				/* Show enrollment color scale key on map */
				enrollcs = map_svg.append("g");
				
				enrollcs.append("text")
					.text("Map Scale Description")
					.attr("x", 50).attr("y", 585)
					.attr("fill", "#777")
					.attr("font-size", "12");
				
				for (var i = 0; i < enrollmentColorScale.length; i++) {
					var xpos = 50 + 15*i;
					var ypos = 560;
					
					enrollcs.append("rect")
						.attr("x", xpos).attr("y", ypos + 5)
						.attr("height", 7).attr("width",15)
						.attr("fill", enrollmentColorScale[i]);

					var scaletext;
					var scaletextcolor = (i % 2 == 0)? "#a7a7a7" : "#dfdfdf";
					if (i == 0) {
						scaletext = "0%";
					}
					else if (i < 5) {
						scaletext = "0." + (i * 2) + "%";
					}
					else if (i == 5) {
						scaletext = "1%";
					}
					else {
						scaletext = (2 + 2 * (i - 6)) + "%";
					}

					enrollcs.append("text")
						.text(scaletext)
						.attr("x", xpos).attr("y", ypos)
						.attr("fill", scaletextcolor)
						.attr("font-size", 10)
						.attr("dominant-baseline", "middle")
						.attr("transform", "rotate(-60," + xpos + ", " + ypos + ")");
				}
				
				
				/* Shade states based on enrollment data */
				d3.csv("enrollment.csv", function (error, data) {										
					data.forEach(function(row){
						map_svg.selectAll(".state-" + row.stateid)
						.attr("fill", enrollmentColor(row.enroll));
					});
				});
				
				
				/* Draw Regional Overview Circles */
				var regionRadialScale = d3.scale.sqrt()
					.domain([0,1]).range([0, 75]);

			});
			
		</script>
    </section>
    
	
	
	
	
	
	<!-- General Utility Functions
	================================================== -->
	<script>


		var r_scale;
		var s_scale;

		/**
		 * Returns the given number as a string with commas as separators.
		 * e.g. 34567 -> "34,567"
		 * src: http://stackoverflow.com/questions/2901102/how-to-print-a-number
		 * -with-commas-as-thousands-separators-in-javascript
		 */
		function numberWithCommas(x) {
    		return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
		}

		/**
		 * 	Return the color associated with each major in the second 
		 * 	(major-based) visualization.
		 */
		function major_color(major) {
			switch (major) {
				case 0:
				case "Applied and Engineering Physics":
					return "#685C79";
				case 1:
				case "Biological and Environmental Engineering":
					return "#99705C";
				case 2:
				case "Chemical and Biomolecular Engineering":
					return "#468966";
				case 3:
				case "Civil and Environmental Engineering":
					return "#466675";
				case 4:
				case "Computer Science":
					return "#3399CC";
				case 5:
				case "Earth and Atmospheric Sciences":
					return "#00A388";
				case 6:
				case "Electrical and Computer Engineering":
					return "#F3B562";
				case 7:
				case "Environmental Engineering":
					return "#F98A5F";
				case 8:
				case "Independent Major":
					return "#BFA78F";
				case 9:
				case "Information Science, Systems, and Technology":
					return "#67B8DE";
				case 10:
				case "Materials Science and Engineering":
					return "#AC6C82";
				case 11:
				case "Mechanical and Aerospace Engineering":
					return "#DE5842";
				case 12:
				case "Operations Research":
					return "#455C7B";
			}
		}
		
		
		function majorAbbr(majorid){
			switch (majorid){
				case 0:
					return "AEP";
				case 1:
					return "BEE";
				case 2:
					return "CBE";
				case 3:
					return "CEE";
				case 4:
					return "CS";
				case 5:
					return "EAS";
				case 6:
					return "ECE";
				case 7:
					return "EE";
				case 8:
					return "INDP";
				case 9:
					return "ISST";
				case 10:
					return "MSE";
				case 11:
					return "MAE";
				case 12:
					return "OR";
				default:
					return "---";
			}
		}
		
		/* Value associated to regions
		 * [0] => New York
		 * [1] => Middle
		 * [2] => New England
		 * [3] => Midwest
		 * [4] => South
		 * [5] => Southwest
		 * [6] => West */
		var regionNames = ["New York", "Middle", "New England", "Midwest", "South", "Southwest", "West"];
		var regionColors = ["#bf2e26", "#0B99BC", "#29ABA4", "#83AA30", "#F38630", "#E94C6F", "#FFD464"];
		var regionCoords = [[-75.1890, 42.3482], [-74.5, 40], [-69, 45.5], [-89.5, 44.5], [-81, 34], [-112, 34], [-120, 37]]
		var regionEnrollment = [0.3618359007, 0.1889342974, 0.100911663, 0.07639107199, 0.09902546369, 0.04746934926, 0.1024834958];
		var regionPostgrad = [0.393316195, 0.084832905, 0.123393316, 0.084832905, 0.089974293, 0.041131105, 0.18251928];
		var regionTransform = ["translate(-50, -115)", "translate(85, 15)", "translate(75, -75)", "translate(-35, -115)", "translate(85, 70)", "translate(-50, 100)", "translate(-100, -125)"]
		var regionStateClasses = [".state-36",
								  ".state-34, .state-42, .state-24, .state-10",
								  ".state-9, .state-23, .state-25, .state-33, .state-44, .state-50",
								  ".state-17, .state-18, .state-19, .state-20, .state-26, .state-27, .state-29, .state-31, .state-38, .state-39, .state-46, .state-55",
								  ".state-12, .state-13, .state-37, .state-45, .state-51, .state-54, .state-1, .state-21, .state-28, .state-47, .state-5, .state-22",
								  ".state-40, .state-48, .state-8, .state-35, .state-4, .state-49",
								  ".state-2, .state-6, .state-15, .state-16, .state-30, .state-32, .state-41, .state-53, .state-56"];
		
		
		/* The first five elements highlight the lower extreme (less than 1%)
		 * of enrollment by state. The other elements gradually step from
		 * the color scale */
		//var enrollmentColorScale = [ "#FFE1E1", "#FFCBCB", "#FFB5B5", "#FFA0A0", "#FF8A8A",
		//		  "#D1D1D1", "#C8C8C8", "#C0C0C0", "#B8B8B8", "#B0B0B0",
		//		  "#A8A8A8", "#A0A0A0", "#989898", "#909090", "#888888",
		//		  "#808080", "#777777", "#6F6F6F", "#676767", "#5F5F5F",
		//		  "#575757", "#4F4F4F", "#474747", "#3F3F3F", "#373737" ];
		
		var enrollmentColorScale = [ "#F0F0F0", "#E0E0E0", "#CFCFCF", "#BFBFBF", "#AFAFAF",
				  "#F0B6B1", "#EBACA8", "#E7A39F", "#E29A95", "#DE908C",
				  "#D98783", "#D57E7A", "#D07471", "#CC6B68", "#C7625F",
				  "#C35856", "#C35856", "#BA4644", "#B63C3B", "#B13332",
				  "#AD2A28", "#A8201F", "#A41716", "#9F0E0D", "#9B0404" ];
		
		/* Given a the enrollment of a state and the max_enrollment, returns a color from a color scale */
		function enrollmentColor(enrollment) {
		
			if (enrollment <= 0.002) { return enrollmentColorScale[0]; }
			else if (enrollment <= 0.004) { return enrollmentColorScale[1]; }
			else if (enrollment <= 0.006) { return enrollmentColorScale[2]; }
			else if (enrollment <= 0.008) { return enrollmentColorScale[3];; }
			else if (enrollment < 0.01) { return enrollmentColorScale[4]; }
			
			else if (enrollment <= 0.02) { return enrollmentColorScale[5]; }
			else if (enrollment <= 0.04) { return enrollmentColorScale[6]; }
			else if (enrollment <= 0.06) { return enrollmentColorScale[7]; }
			else if (enrollment <= 0.08) { return enrollmentColorScale[8]; }
			else if (enrollment <= 0.10) { return enrollmentColorScale[9]; }
			else if (enrollment <= 0.12) { return enrollmentColorScale[10]; }
			else if (enrollment <= 0.14) { return enrollmentColorScale[11]; }
			else if (enrollment <= 0.16) { return enrollmentColorScale[12]; }
			else if (enrollment <= 0.18) { return enrollmentColorScale[13]; }
			else if (enrollment <= 0.20) { return enrollmentColorScale[14]; }
			else if (enrollment <= 0.22) { return enrollmentColorScale[15]; }
			else if (enrollment <= 0.24) { return enrollmentColorScale[16]; }
			else if (enrollment <= 0.26) { return enrollmentColorScale[17]; }
			else if (enrollment <= 0.28) { return enrollmentColorScale[18]; }
			else if (enrollment <= 0.30) { return enrollmentColorScale[19];; }
			else if (enrollment <= 0.32) { return enrollmentColorScale[20]; }
			else if (enrollment <= 0.34) { return enrollmentColorScale[21]; }
			else if (enrollment <= 0.36) { return enrollmentColorScale[22]; }
			else if (enrollment <= 0.38) { return enrollmentColorScale[23]; }
			else if (enrollment <= 0.40) { return enrollmentColorScale[24]; }
			else { return "#000"; }
		}
		
		
		/* Given a state ID, return the name of the corresponding region */
		function identifyRegion(stateID) {
			switch (+stateID) {
				// New York
				case 36:
					return regionNames[0];
				// Middle
				case 34:
				case 42:
				case 24:
				case 10:
					return regionNames[1];
				// New England
				case 9:
				case 23:
				case 25:
				case 33:
				case 44:
				case 50:
					return regionNames[2];
				// Midwest
				case 17:
				case 18:
				case 19:
				case 20:
				case 26:
				case 27:
				case 29:
				case 31:
				case 38:
				case 39:
				case 46:
				case 55:
					return regionNames[3];
				// South
				case 1:
				case 5:
				case 12:
				case 13:
				case 21:
				case 22:
				case 28:
				case 37:
				case 45:
				case 47:
				case 51:
				case 54:
					return regionNames[4];
				// Southwest
				case 4:
				case 8:
				case 35:
				case 40:
				case 48:
				case 49:
					return regionNames[5];
				//West
				case 6:
				case 16:
				case 30:
				case 32:
				case 41:
				case 53:
				case 56:
					return regionNames[6];
				default:
					return "";
			}
		};
		
		
		function regionalColor(state) {
			var region = identifyRegion(state);
			
			for (var i = 0; i < regionNames.length; i++) {
				if (region == regionNames[i]) {
					return region[i];
				}
			}
		}
	</script>
	
	
	
</body>
</html>